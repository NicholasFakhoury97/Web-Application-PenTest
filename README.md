# Web-Application-PenTest
Objective:

The objective of this penetration test was to identify and exploit vulnerabilities in the DC:9 virtual machine provided by VulnHub. The aim was to gain unauthorized access and escalate privileges to obtain the root flag.
Here’s a structured format for your repository, following the style you provided. This will help make your documentation clear and organized for others who might be interested in your penetration testing notes.

---
Setup Overview:

In this lab, we will set up two machines to create a controlled environment for penetration testing. The attack machine will run Ubuntu Server, and the endpoint machine will run Windows 11. This setup involves configuring both machines, disabling security features to ensure smooth operation, and installing key tools for the penetration test.

---

## 1. Information Gathering

### Current IP Address on Kali Linux

- **IP Address:** 192.168.1.233
- **Command:** `ip a`

![image](https://github.com/user-attachments/assets/1dcd1de7-ac3d-4029-a277-a005bc1714a5)

-Identifying the IP address of your attack machine (Kali Linux) is essential for network-based operations. This step confirms the machine's network identity and ensures that you are targeting the correct IP address in subsequent steps.
### ARP Scan to Find Target's MAC Address

- **Steps:** 
  - Go to VirtualBox Manager
  - Navigate to Target Machine Settings
  - Open the Network Tab
  - Click on Advanced to view MAC Address

- **Command:** `sudo arp-scan -l`

![image](https://github.com/user-attachments/assets/d19a9028-4811-4232-a8a5-0bb8b18087dd)

![image](https://github.com/user-attachments/assets/3ccd4f37-1cc8-4252-af68-99fad3d7c714)

- ARP (Address Resolution Protocol) scans the local network to map IP addresses to MAC addresses. This helps identify devices on the network and confirm the MAC address of the target machine. This information can be crucial for network attacks and ensuring correct targeting.

### Alternative Network Discovery

- **Command:** `sudo netdiscover`

![image](https://github.com/user-attachments/assets/c2306713-5d12-483e-936a-6d7b87e50011)

- Netdiscover is another tool for discovering devices on a network. It can be used as an alternative or supplement to ARP scanning to verify the presence and details of target machines. This helps in cross-checking the network layout and device information.

### Verify Connectivity to Target Machine

- **Command:** `fping 192.168.1.228`
- **Note:** If connectivity is working through your attack and target machine, the output should match the provided screenshot.

![image](https://github.com/user-attachments/assets/d79d2692-6c72-4545-8017-ea0da3b5ba10)

- fping is used to check the reachability of the target machine. This command verifies that the target machine is online and responding to network requests. It helps confirm that there are no connectivity issues before proceeding with further attacks.

## 2. Network Scanning

### Nmap Scan Command

- **Command:** `nmap -A -p- 192.168.1.228`

- **Breakdown:**
  - **nmap:** The command-line tool used for network discovery and security auditing.
  - **-A:** Enables Aggressive Scan with features:
    - OS Detection: Identifies the operating system of the target host.
    - Version Detection: Finds versions of services running on open ports.
    - Script Scanning: Runs predefined scripts to gather more information or check vulnerabilities.
    - Traceroute: Maps the route taken by packets from source to destination.
  - **-p-:** Scans all ports from 1 to 65535.
 
![image](https://github.com/user-attachments/assets/c1ca5dd8-05cd-4f78-97c6-126c58523327)
 
  - Conducting a full port scan with nmap -A provides detailed information about the target system's open ports, running services, and potential vulnerabilities. This step is crucial for identifying entry points for further attacks.

## 3. Web Application Enumeration

### Accessed Website via IP Address

- **URL:** [http://192.168.1.228]

![image](https://github.com/user-attachments/assets/c938c916-bb1e-438b-8488-339c275343cd)
![image](https://github.com/user-attachments/assets/c98ac7f5-b55e-4103-82a8-cedc2ff0da8f)
![image](https://github.com/user-attachments/assets/1710943b-fd19-4005-9a85-0ac6e193e429)


- Accessing the website hosted on the target machine allows you to analyze its functionality and identify potential vulnerabilities.

### Identified Vulnerability: SQL Injection

- **Research Reference:** [Rapid7 Web Application Vulnerabilities](https://www.rapid7.com/fundamentals/web-application-vulnerabilities/)
- **Testing Method:**
  - Use the search query box on the site.
  - Capture request with Burp Suite.
  - Save request to file named `GOT`.
 
  ![image](https://github.com/user-attachments/assets/5211edef-3a90-49ff-9df0-adc7c8787ffb)
 
  -  SQL Injection is a common web application vulnerability that allows attackers to interact with the backend database. By capturing and analyzing HTTP requests, you can identify SQL Injection points and craft payloads to exploit them.

### SQL Injection Testing with Sqlmap

- **Command to Check Databases:**
  ```bash
  sqlmap -r GOT --dbs
  ```
- **Dump Databases and User Info:**
  - **Command:** 
    ```bash
    sqlmap -r GOT -D Staff --dump-all --batch
    ```
  - **Dump Users:**
    ```bash
    sqlmap -r GOT -D users --dump-all --batch

 ![image](https://github.com/user-attachments/assets/d72516a2-5148-4a78-a6b9-3490e4c11621)
 ![image](https://github.com/user-attachments/assets/706e2e73-708f-4c78-b7a5-67206964caf7)
 ![image](https://github.com/user-attachments/assets/7160052a-b952-4dbc-a176-f551ee352d42)
 ![image](https://github.com/user-attachments/assets/445a0093-a450-426a-8cf4-a1d8c5f25ac7)
 
    
  - sqlmap is a powerful tool for automating SQL Injection attacks. It helps identify and extract data from databases compromised through SQL Injection. By dumping databases and user information, you can gather valuable data for further exploitation.

## Note: I found a admin username and password that was hashed and decrypted the Password to login to admin on the website. 
Password decrypted: "transorbital1"

![image](https://github.com/user-attachments/assets/0ed49d40-eb88-4860-9b24-e30b81705f4b)
![image](https://github.com/user-attachments/assets/ddf6f59a-d7fd-4358-aa2a-89562b8f0964)


## 4. Local File Inclusion (LFI)

### Testing for LFI

- **Discovery of LFI Vulnerability:**
  - After obtaining the admin credentials, we logged into the web application and noticed that additional features such as "Manage" and "Add Record" were unlocked. However, the footer now displayed the message "File does not exist," suggesting a file inclusion issue.
  
  - We hypothesized that the missing or misplaced file might be included in the footer dynamically. To investigate this further, we tested the URL parameter used for file inclusion. We appended the `?file=` parameter to the URL, attempting to include various local files.

- **URL Parameter Testing:**
  - We used a common LFI testing URL parameter and tried accessing the `/etc/passwd` file with a URL like:
    ```
    http://example.com/welcome.php?file=/etc/passwd
    ```
  - The application returned the contents of `/etc/passwd`, confirming that the LFI vulnerability exists. This file contains sensitive user information, highlighting the risk of unauthorized access due to improper file inclusion.

  - Local File Inclusion vulnerabilities allow attackers to include files from the server’s filesystem. Testing for LFI helps determine if the application improperly exposes files, potentially revealing sensitive information such as `/etc/passwd`.

![image](https://github.com/user-attachments/assets/2b34303a-cad3-433f-b342-32b53710218c)

## 5. Port Knocking

### Detected Port Knocking Configuration

- **Found in:** `knockd.conf`
- **Port Knocking Sequence:** 
  - Use the sequence to open the SSH port.
 
![image](https://github.com/user-attachments/assets/e74e92c6-28ef-489d-be0a-5bdd31ccfdae)
 
  - Port knocking is a method to obscure services by requiring a specific sequence of network requests to open a port. By detecting and using the correct port knocking sequence, you can access otherwise hidden services, such as SSH.

### Knock Tool Installation and Usage

- **Install Knockd:**
  ```bash
  sudo apt-get install knockd
  ```
- **Knock Command:**
  ```bash
  knock <sequence>
  ```

- Brute-forcing SSH credentials involves using tools like Hydra to attempt numerous username and password combinations to gain unauthorized access. Creating dictionaries of potential usernames and passwords increases the likelihood of successful login attempts.
## 6. Exploitation

### SSH Access

- **Brute-Force with Hydra:**
  - **Commands to Create Dictionaries:**
    ```bash
    # Create user.txt and pass.txt from user and password columns.
    ```
  - **Hydra Command for SSH:**
    ```bash
    hydra -L user.txt -P pass.txt ssh://192.168.1.228
    ```

- **Successful Credentials:**
  - **User:** janitor
  - **Password:** [Password found]
 
  - Once you successfully brute-force the credentials, you can use them to access the target machine via SSH.

### Privilege Escalation

- **Create Root User via /etc/passwd:**
  - **Commands:**
    ```bash
    sudo su
    nano /etc/passwd
    ```
  - **Added Line:**
    ```plaintext
    nico:$1$randomsalt$hash:0:0::/root:/bin/bash
    ```
  - **Login as New User:**
    ```bash
    su nico
    ```

- Privilege escalation involves gaining higher-level access on the target machine. By modifying /etc/passwd, you can create a new root user. This allows you to gain full control over the system and perform administrative tasks.
## 7. Post-Exploitation

### Access Root Directory

- **Commands:**
  ```bash
  cd /root
  cat flag.txt
  ```
- After gaining root access, you can explore the root directory to find sensitive files or flags. This step verifies successful exploitation and provides insights into further actions.
### Findings

- **Secrets file and additional passwords discovered.**
- **Use Hydra with updated passwords for further access:**
  ```bash
  hydra -L updated_user.txt -P updated_pass.txt ssh://192.168.1.228
  ```

- Post-exploitation involves using any discovered credentials or sensitive information for further access. This may include additional brute-forcing or reconnaissance based on new findings.
### Final Credential Testing

- **Login with credentials:**
  - **Username:** fredf
  - **Password:** B4-Tru3-001
- **Check sudo rights:**
  ```bash
  sudo -l
  ```

- Testing with final credentials involves verifying if the user has administrative privileges. This ensures that you can perform higher-level tasks on the target machine.
### Commands Used for Final Privilege Escalation

- **Make a root user:**
  ```bash
  cat /etc/passwd
  nano passwd
  ```

  -  Final privilege escalation might involve further modifications to system files to ensure root access or create additional backdoors. This confirms full control over the target machine.
- **Verify with `id` command after login.**

---
